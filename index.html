<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Secure Download</title>

<style>
* { box-sizing: border-box; }

body {
  font-family: Arial, sans-serif;
  background: #FAF9F6;
  padding: 20px;
  margin: 0;
}

.header { text-align: center; margin-bottom: 30px; }
.header h1 { color: #025940; margin: 10px 0 5px; font-size: 28px; line-height: 1.3; }
.header h2 { color: #025940; margin: 5px 0; font-size: 22px; font-weight: normal; }
.header p { color: #5E6666; margin: 5px 0; font-size: 16px; }

.container {
  display: flex;
  gap: 40px;
  max-width: 1000px;
  margin: 0 auto;
  align-items: center;
  flex-wrap: wrap;
}

.form-column, .image-column { flex: 1; min-width: 300px; }
.image-column img { max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(2, 89, 64, 0.15); }

form {
  background: #fff;
  padding: 30px;
  border-radius: 8px;
  border-top: 4px solid #025940;
  box-shadow: 0 2px 8px rgba(2, 89, 64, 0.1);
}

input, button {
  width: 100%;
  padding: 12px;
  margin-top: 10px;
  border-radius: 4px;
  font-size: 14px;
}

input { border: 1px solid #ddd; }
input:focus { outline: none; border-color: #025940; box-shadow: 0 0 0 3px rgba(2, 89, 64, 0.1); }

button {
  background: #025940; color: #fff; border: none; font-weight: bold;
  cursor: pointer; transition: background 0.3s ease;
}
button:hover { background: #034630; }
button:disabled { background: #999; cursor: not-allowed; opacity: 0.7; }

.loading { display: none; text-align: center; margin-top: 20px; }
.spinner {
  border: 4px solid #f3f3f3;
  border-top: 4px solid #025940;
  border-radius: 50%; width: 40px; height: 40px;
  animation: spin 1s linear infinite;
  margin: 0 auto 10px;
}
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

/* Modal */
.modal {
  display: none;
  position: fixed; z-index: 1000;
  left: 0; top: 0;
  width: 100%; height: 100%;
  background-color: rgba(0,0,0,0.5);
  align-items: center;
  justify-content: center;
}
.modal.show { display: flex; }

.modal-content {
  background: #fff;
  padding: 30px;
  border-radius: 8px;
  width: 90%; max-width: 400px;
  text-align: center;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
.modal-content.success h2 { color: #0d7c4d; }
.modal-content.error h2 { color: #e74c3c; }
.modal-buttons { margin-top: 20px; }
.modal-buttons button, .modal-buttons a {
  margin: 10px 5px;
  width: auto; padding: 10px 20px;
  border-radius: 4px; font-weight: bold;
  text-decoration: none;
  cursor: pointer;
}
.modal-buttons a { background: #025940; color: white; }
.modal-buttons a:hover { background: #034630; }

/* Mobile */
@media(max-width:768px){ 
  .container{ flex-direction: column; gap:30px; }
  .form-column, .image-column{ width: 100%; min-width: unset; }
  .header h1 { font-size: 24px; }
  .header h2 { font-size: 18px; }
  .header p { font-size: 14px; }
  form { padding: 20px; }
  input, button { padding: 10px; font-size: 13px; }
}

@media(max-width:480px){
  body { padding: 15px; }
  .header h1 { font-size: 20px; }
  .header h2 { font-size: 16px; }
  .header p { font-size: 13px; }
  form { padding: 15px; }
  input, button { padding: 9px; font-size: 12px; }
  .modal-content { padding: 20px; width: 95%; }
}
</style>
</head>

<body>

<div class="header">
  <h1>Get More Information</h1>
  <h2>About the National Housing Fund</h2>
  <p>(NHF) Scheme</p>
</div>

<div class="container">
  <div class="form-column">
    <form id="leadForm">
      <input name="firstName" placeholder="First Name" required>
      <input name="lastName" placeholder="Last Name" required>
      <input type="email" name="email" placeholder="Email" required>
      <input type="tel" name="phone" placeholder="Phone Number" required>
      <button type="submit" id="submitBtn">Submit & Download</button>
    </form>

    <div class="loading" id="loadingBox">
      <div class="spinner"></div>
      <p>Submitting your information...</p>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal">
      <div class="modal-content success">
        <h2>‚úÖ Success!</h2>
        <p>Thank you for getting in touch. Your information has been submitted successfully.</p>
        <p>Your download is ready:</p>
        <div class="modal-buttons">
          <a href="https://www.dcpehvpm.org/E-Content/BCA/BCA-III/artificial_intelligence_tutorial.pdf" target="_blank">üìÑ Download PDF</a>
          <button onclick="closeModal()">Close</button>
        </div>
      </div>
    </div>

    <!-- Error Modal -->
    <div id="errorModal" class="modal">
      <div class="modal-content error">
        <h2>‚ö†Ô∏è Error</h2>
        <p id="errorMessage"></p>
        <div class="modal-buttons">
          <button onclick="closeErrorModal()">Try Again</button>
        </div>
      </div>
    </div>

  </div>

  <div class="image-column">
    <img src="assets/iicocece.png" alt="Brand Image">
  </div>
</div>

<script>
const form = document.getElementById("leadForm");
const submitBtn = document.getElementById("submitBtn");
const loadingBox = document.getElementById("loadingBox");
const successModal = document.getElementById("successModal");
const errorModal = document.getElementById("errorModal");
const errorMessage = document.getElementById("errorMessage");

function closeModal() {
  successModal.classList.remove('show');
  document.body.style.overflow = "auto";
  form.reset();
  form.style.display = "block";
  submitBtn.disabled = false;
}

function closeErrorModal() {
  errorModal.classList.remove('show');
  submitBtn.disabled = false;
}

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const firstName = form.firstName.value.trim();
  const lastName = form.lastName.value.trim();
  const email = form.email.value.trim();
  const phone = form.phone.value.trim();

  if (!firstName || !lastName || !email || !phone) {
    errorMessage.textContent = "Please fill in all fields.";
    errorModal.classList.add('show');
    return;
  }

  const payload = { firstName, lastName, email, phone };

  submitBtn.disabled = true;
  loadingBox.style.display = "block";

  try {
    const response = await fetch("https://script.google.com/macros/s/AKfycbyFjX2m5wgQVN2OFOvyRLIxB_Su5yjpUcoWYvwFXsPEV3EQy4LTWmjabM7NbSzFxI8/exec", {
      method: "POST",
      headers: { 'Content-Type': 'text/plain;charset=utf-8' },
      body: JSON.stringify(payload)
    });

    const result = await response.json();
    loadingBox.style.display = "none";

    if (result.success === true) {
      form.style.display = "none";
      successModal.classList.add('show');
      document.body.style.overflow = "hidden";
    } else {
      errorMessage.textContent = result.message || "An error occurred. Please try again.";
      errorModal.classList.add('show');
      submitBtn.disabled = false;
    }
  } catch (error) {
    console.error(error);
    loadingBox.style.display = "none";
    errorMessage.textContent = "Network error. Please try again.";
    errorModal.classList.add('show');
    submitBtn.disabled = false;
  }
});

// Close modals by clicking outside
window.onclick = function(event) {
  if(event.target === successModal) closeModal();
  if(event.target === errorModal) closeErrorModal();
}
</script>

</body>
</html>
